<%= tr8n_with_options_tag(:default_locale => Tr8n::Config.default_admin_locale, :admin => true) do %>

  <%= render :partial => "/tr8n/app/common/header" %>
  <div class="tr8n tr8n_container">

    <div class="section_title">
      <%=render(:partial => "sections") %>
      <%=tra("Email Templates") %>
    </div>

    <div class="section grey">
      <div class="tr8n_fltr" style="padding-right:5px;">
        <%=tr8n_help_icon_tag("Email Templates") %>
      </div>

      <div class="tr8n_txtl" style="padding-top:5px;padding-bottom:20px;font-size:12px;">
        <%= tra("Here you can configure custom emails sent to translators") %>
      </div>

      <div class="text-right">
        <%=link_to("Add Email Template", {:controller => "/tr8n/app/wizards", :action => :email_template}, {"class" => "btn btn-primary", "data-toggle" => "dynamic_wizard"})%>
      </div>
    </div>

    <div class="section">

      <table class="table table-hover">
        <thead>
        <tr>
          <th style="width:100px;"><%=tra("Keyword") %></th>
          <th style="width:150px"><%=tra("Name") %></th>
          <th style="width:150px"><%=tra("Description") %></th>
          <th style="width:100px;"></th>
        </tr>
        </thead>
        <tbody>
        <% selected_application.email_templates.each do |et| %>
          <tr>
            <td>
              <%= et.keyword%>
            </td>
            <td>
              <%= et.name%>
            </td>
            <td>
              <%= et.description%>
            </td>
            <td style="text-align:right">
              <%=link_to_function(tra("Preview"), "previewEmail(#{et.id})", :class => "btn") %>
              <%=link_to(tra("Edit"), {:action => :email_template, :id => et.id}, :class => "btn") %>
            </td>
          </tr>
        <% end %>
        </tbody>
      </table>

    </div>

  </div>
  <%= render :partial => "/tr8n/app/common/footer" %>

  <%= stylesheet_link_tag('tr8n/bootstrap/bootstrap-switch.css') %>
  <%=javascript_include_tag('tr8n/vendor/bootstrap/bootstrap-switch.js') %>

<% end %>

<script>
  function previewEmail(id) {
    var w = 800;
    var h = 600;
    var left = (screen.width/2)-(w/2);
    var top = (screen.height/2)-(h/2);
    var url = "/tr8n/app/settings/email_preview?id=" + id;
    return window.open(url, "Tr8n Email Preview", 'toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=no, resizable=no, copyhistory=no, width='+w+', height='+h+', top='+top+', left='+left);
  }
</script>